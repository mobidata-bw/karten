{
  "version": 3,
  "sources": ["../../maplibre-gl-style-flipper/index.js"],
  "sourcesContent": ["// Define the StyleFlipperControl class\r\nclass StyleFlipperControl {\r\n  constructor(styles, onStyleChange) {\r\n    this.styles = styles;\r\n    this.onStyleChange = onStyleChange;\r\n    this.buttons = {};\r\n    this.currentStyleCode = null;\r\n    this.customSourcesAndLayers = {};\r\n  }\r\n\r\n  onAdd(map) {\r\n    this.map = map;\r\n\r\n    // Create the control container\r\n    this.container = document.createElement(\"div\");\r\n    this.container.className =\r\n      \"maplibregl-ctrl maplibregl-ctrl-group style-flipper-control\";\r\n\r\n    // Add a button for each style\r\n    for (const [styleClass, styleData] of Object.entries(this.styles)) {\r\n      const button = document.createElement(\"button\");\r\n      button.type = \"button\";\r\n      button.className = `map-style ${styleClass}`;\r\n      button.title = `Switch to ${styleClass}`;\r\n\r\n      // Add an image to the button\r\n      const img = document.createElement(\"img\");\r\n      img.src = styleData.image;\r\n      img.alt = styleClass;\r\n      img.style.width = \"100%\";\r\n      button.appendChild(img);\r\n\r\n      // Add a click event listener\r\n      button.addEventListener(\"click\", () => {\r\n        this.saveCustomSourcesAndLayers();\r\n        this.map.setStyle(styleData.url);\r\n        this.currentStyleCode = styleData.code;\r\n        this.highlightActiveStyle(styleClass);\r\n        this.map.once(\"styledata\", () => {\r\n          this.restoreCustomSourcesAndLayers();\r\n        });\r\n        if (this.onStyleChange) {\r\n          this.onStyleChange(styleClass, styleData.code);\r\n        }\r\n      });\r\n\r\n      this.container.appendChild(button);\r\n      this.buttons[styleClass] = button;\r\n    }\r\n\r\n    // Highlight the current style\r\n    this.highlightActiveStyle(this.getCurrentStyleClass());\r\n\r\n    return this.container;\r\n  }\r\n\r\n  onRemove() {\r\n    this.container.parentNode.removeChild(this.container);\r\n    this.map = undefined;\r\n  }\r\n\r\n  highlightActiveStyle(activeStyleClass) {\r\n    Object.values(this.buttons).forEach((button) => {\r\n      button.classList.remove(\"active\");\r\n    });\r\n    if (activeStyleClass && this.buttons[activeStyleClass]) {\r\n      this.buttons[activeStyleClass].classList.add(\"active\");\r\n    }\r\n  }\r\n\r\n  getCurrentStyleClass() {\r\n    if (!this.currentStyleCode) {\r\n      return null;\r\n    }\r\n    for (const [styleClass, styleData] of Object.entries(this.styles)) {\r\n      if (styleData.code === this.currentStyleCode) {\r\n        return styleClass;\r\n      }\r\n    }\r\n    return null;\r\n  }\r\n\r\n  setCurrentStyleCode(code) {\r\n    this.currentStyleCode = code;\r\n    this.highlightActiveStyle(this.getCurrentStyleClass());\r\n  }\r\n\r\n  saveCustomSourcesAndLayers() {\r\n    this.customSourcesAndLayers = {\r\n      sources: {},\r\n      layers: [],\r\n    };\r\n    const sources = this.map.getStyle().sources;\r\n    for (const [sourceId, source] of Object.entries(sources)) {\r\n      if (!source.url) {\r\n        this.customSourcesAndLayers.sources[sourceId] = source;\r\n      }\r\n    }\r\n    const layers = this.map.getStyle().layers;\r\n    for (const layer of layers) {\r\n      if (this.customSourcesAndLayers.sources[layer.source]) {\r\n        this.customSourcesAndLayers.layers.push(layer);\r\n      }\r\n    }\r\n  }\r\n\r\n  restoreCustomSourcesAndLayers() {\r\n    for (const [sourceId, source] of Object.entries(\r\n      this.customSourcesAndLayers.sources\r\n    )) {\r\n      this.map.addSource(sourceId, source);\r\n    }\r\n    for (const layer of this.customSourcesAndLayers.layers) {\r\n      this.map.addLayer(layer);\r\n    }\r\n  }\r\n}\r\n\r\n// Add CSS for the control\r\nconst style = document.createElement(\"style\");\r\nstyle.textContent = `\r\n    .style-flipper-control {\r\n      display: flex;\r\n      flex-direction: row;\r\n      align-items: center;\r\n      gap: 2px;\r\n      padding: 4px;\r\n      background: white;\r\n      border-radius: 2px;\r\n      box-shadow: 0 1px 4px rgba(0, 0, 0, 0.3);\r\n    }\r\n  \r\n    .style-flipper-control .map-style {\r\n      width: 36px;\r\n      height: 36px;\r\n      background: transparent;\r\n      cursor: pointer;\r\n      padding: 0;\r\n      display: flex;\r\n      align-items: center;\r\n      justify-content: center;\r\n    }\r\n  \r\n    .style-flipper-control .map-style:hover {\r\n      background: rgba(0, 0, 0, 0.1);\r\n    }\r\n  \r\n    .style-flipper-control .map-style.active {\r\n      border: 3px solid rgb(209, 62, 86);\r\n    }\r\n  \r\n    .style-flipper-control .map-style img {\r\n      width: 100%;\r\n      height: 100%;\r\n    }\r\n  `;\r\ndocument.head.appendChild(style);\r\n\r\nexport default StyleFlipperControl;\r\n"],
  "mappings": "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",
  "names": []
}
